# 20.3.06 Demo: Loading and Using JSON
```
20.3.06 Demo: Loading and Using JSON
```
 *Video:* [https://www.youtube.com/watch?v=25omXt_OjD4](https://www.youtube.com/watch?v=25omXt_OjD4)

---

**Things to focus on:**
* writing json files
* Calling and using the data inside jsons
* Async loading functions


## Step 1: Create a Simple JSON File

Make a file named **`data.json`** and save it in your sketch folder.

**Notice:**

* in `.json` we **DO NOT** use `let name =` like in sketches
* all text must be in `"quotes"`
* each line ends with a comma `,`

```json
{
  "name": "Luna",
  "age": 3,
  "species": "Cat"
}
```

---

## Step 2: Load JSON with a Promise

> [!NOTE]
> ## INFODUMP:
>
> `loadJSON()` runs **asynchronously**, which means it loads data **in the background** while your sketch keeps running.
>
> When you call:
>
> ```js
> data = await loadJSON("data.json");
> ```
>
> you’re basically saying:
>
> > “Hey, go get this file. I’ll wait right here until it’s ready.”
>
> This uses something called a **Promise**, which means:
>
> > “I promise to give you this data once it’s loaded.”
>
>  Using `async` and `await` makes Promises easy to use.
> 


1. **Declare an empty variable**

   ```js
   let petData;
   ```

2. **Make a loader function using `async` and `await`**

   ```js
   async function loadStuff() {
     petData = await loadJSON("data.json");
   }
   ```

3. **Call `loadStuff()` in `setup()`**

   ```js
   function setup() {
     createCanvas(400, 200);
     textSize(18);
     background(220);
     loadStuff();
   }
   ```

4. **Show your data in `draw()`**

   ```js
   function draw() {
     background(222);
     if (petData) {
       text("Name: " + petData.name, 20, 60);
       text("Age: " + petData.age, 20, 90);
       text("Species: " + petData.species, 20, 120);
     } else {
       text("Loading data...", 20, 60);
     }
   }// end draw
   ```

---

### Common Mistakes

| Mistake                    | Why It Happens                        | Fix                                              |
| -------------------------- | ------------------------------------- | ------------------------------------------------ |
| Forgot `async`             | `await` only works in async functions | Add `async` before your function                 |
| Tried to use data too soon | JSON hasn’t loaded yet                | Use `if (petData)` to check first                |
| JSON syntax error          | Missing commas, quotes, or braces     | Validate at [jsonlint.com](https://jsonlint.com) |
| Wrong file location        | File not found                        | Keep `data.json` in same folder as your sketch   |

---

## Step 3: Handling Multiple Entries with Arrays
Our JSON has:
* pets
  * Each pet is its own object `pets[0]`
    * that object contains its name and species `pets[0].name`
```json
{
  "pets": [
    { "name": "Luna", "species": "Cat" },
    { "name": "Max", "species": "Dog" },
    { "name": "Kiwi", "species": "Bird" }
  ]
}
```

```js
let pets// empty waiting to hold the json data
// for our if() an empty variable is the same as saying false


async function loadStuff() {
  let data = await loadJSON("data.json");
  pets = data.pets;
}

function draw() {
  background(222);
  if (pets) {  //if pets is filled it is true
    for (let i = 0; i < pets.length; i++) {
      let p = pets[i]// you could also do pets[i].name in the text()
      text(p.name + " is a " + p.species, 20, 50 + i * 30);
    }
  } else {
    text("Loading pets...", 20, 50);
  }
}
```

---

## Step 3.5: Arrays *Inside* an Object

Sometimes each item in your JSON might have **its own array inside it**.
For example, each **character** might have a **list of quotes**, or each **student** might have a **list of grades**.

### `characters.json`

```json
{
  "characters": [
    {
      "name": "Ralph Wiggum",
      "quotes": [
        "Me fail English? That's unpossible.",
        "They taste like... burning.",
        "Hi Super Nintendo Chalmers!"
      ]
    },
    {
      "name": "Homer Simpson",
      "quotes": [
        "D'oh!",
        "Mmm... donuts.",
        "I'm not lazy, I'm on energy-saving mode."
      ]
    }
  ]
}
```

### simpsons sketch

```js
let characters;

async function loadStuff() {
  let data = await loadJSON("characters.json");
  characters = data.characters;
}

function setup() {
  createCanvas(400, 300);
  textSize(14);
  loadStuff();
}

function draw() {
  background(230);

  if (characters) {
    for (let i = 0; i < characters.length; i++) {
      let c = characters[i];
      text(c.name + " says:", 20, 40 + i * 100);

      // Loop through their quotes
      for (let j = 0; j < c.quotes.length; j++) {
        text("- " + c.quotes[j], 40, 60 + i * 100 + j * 20);
      }
    }
  } else {
    text("Loading characters...", 20, 40);
  }
}
```
> [!NOTE] 
> **Why this matters:**
> You’ll often have **structured data**, like players with inventories, enemies with attacks, or characters with multiple quotes.
> This structure (objects → arrays → objects) is the backbone of how complex games and apps manage data.


## Step 4: Use JSON to Control Drawing

Create **shapes.json**

```json
{
  "shapes": [
    { "x": 100, "y": 100, "size": 50, "colour": "red" },
    { "x": 200, "y": 150, "size": 80, "colour": "blue" },
    { "x": 300, "y": 120, "size": 40, "colour": "green" }
  ]
}
```

```js
let shapes;

async function loadStuff() {
  let data = await loadJSON("shapes.json");
  shapes = data.shapes;
}

function draw() {
  background(222);

  if (shapes) {
    for (let i = 0; i < shapes.length; i++) {
      fill(shapes[i].colour);
      ellipse(shapes[i].x, shapes[i].y, shapes[i].size);
    }
  } else {
    text("Loading shapes...", 20, 50);
  }
}
```

---
