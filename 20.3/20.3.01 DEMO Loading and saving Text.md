# 20.3.01 DEMO Loading and saving Text
```
20.3.01 DEMO Loading and saving Text
```

**Things to focus on:**
* Coding HTML textboxes, Buttons
* Downloading and uploading the user inputs

 
> [!NOTE]
> ## INFODUMP:
>
> In p5.js, you can mix **HTML elements** (textboxes, buttons, file inputs) with your canvas.
> These are created using special functions like:
>
> * `createInput()` → makes a textbox
> * `createButton()` → makes a clickable button
> * `createFileInput()` → lets you upload files
>
> Files can be **saved** with `saveStrings()` and **loaded** using event callbacks.
>
> All file operations are **asynchronous**, meaning they happen in the background.
>

### 1. Create a Textbox

1. **Make a Textbox**

   * Create an input field with `createInput("Type something here...")`.
   * Store it in a variable (e.g., `inputBox`).
   * Use `inputBox.position(x, y)` to place it on the page.
   * Use `inputBox.size(width)` to set how wide it is.

3. **Display the User’s Input**

   * Use `text()` to show `"You typed: "` plus whatever is typed in the box.
   * Get the typed text using `inputBox.value()`.



```javascript
let inputBox; // <--- ohhh look at me

function setup() {
  createCanvas(400, 200);
  background(240);

  // 1. Create a textbox (HTML input field)
  inputBox = createInput("Type something here...");
  inputBox.position(20, 30);  // place it on the page (x,y)
  inputBox.size(200);         // set the width

  textSize(16);
  
}

function draw() {
  background(240);
  // 2. Display what’s currently typed
  text("You typed: " + inputBox.value(), 20, 100);
}
```
> [!NOTE]
>* `.value()` gets whatever text is inside the input box. 
>* HTML elements like textboxes are not drawn on the canvas; they sit on top of it.
>
> ---

### 2. Add a Button to Save as `.txt`

3. **Add a Button for Saving the File**

   * Use `createButton("Save as .txt")` to make a clickable button.
   * Place it with `saveButton.position(20, 70)`.
   * Tell the button what to do when clicked using `saveButton.mousePressed(saveText)`, this means it will run a function called `saveText()`.

4. **Make the `saveText()` Function**

   * Inside the function, get the current text from the input box using `inputBox.value()`.
   * Use `saveStrings([textToSave], "myNotes.txt")` to save it as a text file.
   * Print `"File saved!"` in the console to confirm that it worked.


```javascript
let inputBox, saveButton;

function setup() {
  createCanvas(400, 200);
  background(240);

  
  inputBox = createInput("Type your notes...");
  inputBox.position(20, 30);
  inputBox.size(250);

  // 3. Make a button that triggers file save
  saveButton = createButton("Save as .txt")
  saveButton.position(20, 70);
  saveButton.mousePressed(saveText);  // run saveText() when clicked
}

function saveText() {
  // 4. Get the text and save it
  let textToSave = inputBox.value();
  saveStrings([textToSave], "myNotes.txt"); //see note Regarding []
  print("File saved!");
}
```
> [!NOTE]
> **IMPORTANT NOTE:**
> 
>* The `saveStrings()` function saves your text as a file.
>* The text is wrapped in square brackets `[]` to make it an array of lines.


### 3. Upload and Display a `.txt` File

6. **Add a File Upload Button**

   * Use `createFileInput(handleFile)` to make a file picker button.
      * The `handleFile` is a function we create to .... handle the file
      * When the user uploads a file, the `handleFile()` function will run automatically. 
   * Position it with `fileInput.position(20, 20)`.
 

7. **Defining handleFile(file)**

   * Inside `handleFile(file)`, we need to check if the uploaded file is a text file using:

     ```js
     if (file.type === 'text')
     ```
   * This helps prevent crashes if someone uploads the wrong type of file
      * It is always best to assume your user is a fool that only knows how to *sometimes* turn a computer on... and will break everything else

8. **Store the File Contents in a List (Array)**

   * Use `file.data.split('\n')` to break the text file into *separate lines*.
      * Each time the code sees a new line that line of text becomes one item in a list (array).
      * `\n` is a new line indicator.
      * The `\` is located above your enter key


     ```js
     ["Line one", "Line two", "Line three"]
     ```
   * This makes it easier to draw or edit each line separately on the canvas.

5. **Display Each Line of the Uploaded File**

   * In the `draw()` function, loop through the list with a `for` loop:

     ```js
     for (let i = 0; i < fileContent.length; i++) {
       text(fileContent[i], 20, 100+(i*20) );
     }
     ```
   


```javascript
let fileInput;// LOOK AT ME
let fileContent = [];// ME TOO

function setup() {
  createCanvas(500, 300);
  background(240);
  textSize(16);

  //6. updlaod buttons
  fileInput = createFileInput(handleFile);
  fileInput.position(20, 20);
 }

function handleFile(file) {
  // 7. Make sure it's a text file
  if (file.type === 'text') {
    fileContent = file.data.split('\n'); //8. split into lines
  } else {
    print("Not a text file!");
  }
}

function draw() {
  background(240);
  text("Upload a .txt file to display its contents:", 20, 60);

  // 9. Show each line of the uploaded file
  for (let i = 0; i < fileContent.length; i++) {
    text(fileContent[i], 20, 100 + i * 20);
  }
}
```

> [!NOTE]
> **IMPORTANT NOTE:**
>
> * The `handleFile()` function automatically runs after a file is selected.
> * `file.data` gives you the text inside the file.
> * `.split('\n')` makes a new entry into your list with the line info


### 4. Upload and Show an Image

```javascript
let imgInput;
let myImage;

function setup() {
  createCanvas(500, 400);
  background(200);

  // 1. Create an upload button for images
  imgInput = createFileInput(handleImage);
  imgInput.position(20, 20);

  textSize(16);
  text("Upload an image file (JPG, PNG, etc.)", 20, 60);
}

function handleImage(file) {
  // 2. Make sure it’s an image
  if (file.type === 'image') {
    myImage = createImg(file.data, "Uploaded Image");
    myImage.hide();  // hide the HTML version
  } else {
    print("That’s not an image!");
  }
}

function draw() {
  background(200);
  text("Upload an image file (JPG, PNG, etc.)", 20, 60);

  // 3. Draw the image on the canvas
  if (myImage) {
    image(myImage, 100, 100, 300, 200);
  }
}
```
> [!NOTE]
> **IMPORTANT NOTE:**
> 
> * `createImg()` loads the uploaded image as an HTML element.
> * `myImage.hide()` hides it so you can draw it on the p5 canvas using `image()`.


## TL;DR

| Feature          | Function                    | Purpose                              |
| ---------------- | --------------------------- | ------------------------------------ |
| **Textbox**      | `createInput()`             | Let the user type text               |
| **Button**       | `createButton()`            | Create a clickable button            |
| **Save File**    | `saveStrings()`             | Download user input as a `.txt` file |
| **Upload File**  | `createFileInput()`         | Let users upload files               |
| **Display Text** | `.split('\n')`              | Split file text into readable lines  |
| **Upload Image** | `createImg()` and `image()` | Display uploaded images              |



